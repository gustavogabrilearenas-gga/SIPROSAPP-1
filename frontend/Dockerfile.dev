# ============================================
# Dockerfile para SIPROSA MES - Frontend (Desarrollo)
# ============================================

FROM node:18-alpine

# Instalar dependencias necesarias para desarrollo
RUN apk add --no-cache libc6-compat

WORKDIR /app

# Copiar archivos de configuración primero para aprovechar la caché
COPY package*.json ./
COPY tsconfig.json ./
COPY next.config.js ./
COPY scripts ./scripts/

# Instalar dependencias con caché
RUN npm install

# Crear directorio de caché de Next.js
RUN mkdir -p .next/cache/webpack

# Variables de entorno para desarrollo
ENV PORT 3000
ENV NODE_ENV development
ENV NEXT_TELEMETRY_DISABLED 1

# Exponer puerto
EXPOSE 3000

# Comando para iniciar en modo desarrollo con precompilación
CMD ["npm", "run", "dev"]
